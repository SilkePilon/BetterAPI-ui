import{f as x,V as _,G as d,_ as p,B,e as y,d as o,K as A,p as n,i as s}from"./q-babceb26.js";import{p as b,k as S,K as g}from"./q-46ad7b8f.js";import{B as L}from"./q-937f2088.js";import{L as m}from"./q-522e5ac7.js";import{S as E}from"./q-ce8d7ed8.js";const T={I:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],O:[[1,1],[1,1]],T:[[0,1,0],[1,1,1],[0,0,0]],S:[[0,1,1],[1,1,0],[0,0,0]],Z:[[1,1,0],[0,1,1],[0,0,0]],J:[[1,0,0],[1,1,1],[0,0,0]],L:[[0,0,1],[1,1,1],[0,0,0]]};class O{constructor(t,i,e){this.grid=i,this.position=e,this.shape=T[t]}move(t){const i={x:this.position.x+t.x,y:this.position.y+t.y};this.isColliding(i,this.shape)||(this.position=i)}rotate(){const t=this.getRotatedShape();this.isColliding(this.position,t)||(this.shape=t)}getRotatedShape(){const t=this.shape.length,i=Array.from({length:t},()=>Array(t).fill(0));for(let e=0;e<t;++e)for(let r=0;r<t;++r)i[e][r]=this.shape[t-r-1][e];return i}isColliding(t,i){for(let e=0;e<i.length;++e)for(let r=0;r<i[e].length;++r)if(i[e][r]&&(this.grid[t.y+e]===void 0||this.grid[t.y+e][t.x+r]===void 0||this.grid[t.y+e][t.x+r]))return!0;return!1}}const K="#AF93FF16",I="#AF93FF0F",l=32,v=["ArrowLeft","ArrowUp","ArrowDown","ArrowRight"],w=10,k=()=>Array.from({length:20},()=>Array(w).fill(0));class Z{constructor(t,i){this.lastUpdate=0,this.isStarted=!1,this.isVisible=null,this.canvas=t,this.context=this.canvas.getContext("2d"),this.grid=k(),this.activeBlock=this.generateNewBlock(),this.isVisible=i,this.setupControls()}clearLines(){const t=[];this.grid.forEach((i,e)=>{i.every(r=>r>0)&&t.push(e)}),t.forEach(i=>{this.grid.splice(i,1),this.grid.unshift(Array(10).fill(0))})}generateNewBlock(){const t=["I","O","T","S","Z","J","L"],i=t[Math.floor(Math.random()*t.length)];let e=0;i==="I"||i==="O"?e=-1:(i==="T"||i==="S"||i==="Z"||i==="J"||i==="L")&&(e=-2);const r={x:Math.floor(w/2)+e,y:0};return new O(i,this.grid,r)}start(){this.isStarted=!0,this.loop(0)}loop(t){t-this.lastUpdate>500&&(this.update(),this.lastUpdate=t),this.draw(),requestAnimationFrame(e=>this.loop(e))}update(){this.activeBlock.move({x:0,y:1}),this.isBlockSet()&&(this.mergeBlockToGrid(),this.clearLines(),this.activeBlock=this.generateNewBlock(),this.isGameOver()&&(this.grid=k()))}draw(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawGrid(this.grid),this.drawBlock(this.activeBlock)}drawGrid(t){t.forEach((i,e)=>{i.forEach((r,c)=>{r&&this.drawSquare(c,e)})})}drawBlock(t){t.shape.forEach((i,e)=>{i.forEach((r,c)=>{r&&this.drawSquare(t.position.x+c,t.position.y+e)})})}isBlockSet(){const t={x:this.activeBlock.position.x,y:this.activeBlock.position.y+1};return this.activeBlock.isColliding(t,this.activeBlock.shape)}mergeBlockToGrid(){this.activeBlock.shape.forEach((t,i)=>{t.forEach((e,r)=>{e&&(this.grid[this.activeBlock.position.y+i][this.activeBlock.position.x+r]=1)})})}drawSquare(t,i){this.context.fillStyle=K,this.context.fillRect(t*l,i*l,l,l),this.context.strokeStyle=I,this.context.strokeRect(t*l,i*l,l,l)}isGameOver(){return this.activeBlock.isColliding(this.activeBlock.position,this.activeBlock.shape)}setupControls(){const t={ArrowRight:!1,ArrowLeft:!1,ArrowDown:!1},i=e=>{var c,u,f;const r=e.key;!v.includes(r)||!((c=this.isVisible)!=null&&c.value)||(e.preventDefault(),this.isStarted||(this.start(),(u=this.onStart)==null||u.call(this)),(f=this.onAction)==null||f.call(this,r),e.key==="ArrowUp"?this.activeBlock.rotate():t[e.key]||(t[e.key]=!0,this.moveByKey(e.key),setTimeout(()=>{t[e.key]=!1},150)))};document.addEventListener("keydown",i),document.addEventListener("keyup",e=>{(e.key==="ArrowRight"||e.key==="ArrowLeft"||e.key==="ArrowDown")&&(e.preventDefault(),t[e.key]=!1)})}moveByKey(t){t==="ArrowRight"?this.activeBlock.move({x:1,y:0}):t==="ArrowLeft"?this.activeBlock.move({x:-1,y:0}):t==="ArrowDown"&&this.activeBlock.move({x:0,y:1})}}const P=a=>{const[t]=x();t.value=v.indexOf(a),clearTimeout(b.timeout),b.timeout=setTimeout(()=>{t.value=-1},100)},R=()=>{const[a]=x();a.value=!0},D=_(d(()=>p(()=>import("./q-ca9683dd.js"),["build/q-ca9683dd.js","build/q-babceb26.js","build/q-27738f26.js","build/q-46ad7b8f.js","build/q-6b8e21d1.js","build/q-937f2088.js","build/q-522e5ac7.js","build/q-ce8d7ed8.js"]),"s_SuWKo7mXpTM")),C="/home/build/q-d228e6d6.png",G="/home/build/q-cb7440aa.png",V="/home/build/q-87e25bb5.png",J=()=>{B(d(()=>p(()=>Promise.resolve().then(()=>h),void 0),"s_W63jK5fOeLw"));const a=y(-1),t=y(!1);return o("div",null,{class:A(i=>["tetris",{"tetris-playing":i.value}],[t])},[o("div",null,{class:"tetris-box"},[n(m,{src:C,hideOnMobile:!0,alt:"",class:"tetris-background tetris-background-playing",[s]:{src:s,hideOnMobile:s,alt:s,class:s}},3,"0J_1"),n(m,{mobileSrc:V,src:G,alt:"",class:"tetris-background tetris-background-default",[s]:{mobileSrc:s,src:s,alt:s,class:s}},3,"0J_2"),o("div",null,{class:"tetris-game-board-wrapper"},o("div",null,{class:"tetris-game-board"},null,3,null),3,null),n(D,{onStart$:d(()=>p(()=>Promise.resolve().then(()=>h),void 0),"s_IoH6X4TLWDA",[t]),onAction$:d(()=>p(()=>Promise.resolve().then(()=>h),void 0),"s_x9weZ5KDWSY",[a]),[s]:{onStart$:s,onAction$:s}},3,"0J_3"),o("div",null,{class:"tetris-box-content"},[n(E,{subtitle:"Academy",title:["Learn how to take great","notes at our academy"],mobileTitle:["Learn how to take","great notes at","our academy"],description:"Master the principles of note-taking in <br /> Reflect's free online Academy.",[s]:{subtitle:s,title:s,mobileTitle:s,description:s}},3,"0J_4"),n(L,{type:"secondary",onClick$:d(()=>p(()=>Promise.resolve().then(()=>h),void 0),"s_PrcrG2piNtU"),children:"Take the course",[s]:{type:s,onClick$:s}},3,"0J_5")],1,null)],1,null),o("div",null,{class:"tetris-keys"},[o("div",null,{class:"tetris-keys-group"},[o("div",null,{class:"tetris-keys-group-label"},"Press “Controls” to play:",3,null),S.map((i,e)=>n(g,{index:e,pressedKeyIndex:a,[s]:{pressedKeyIndex:s}},3,e))],1,null),o("div",null,{class:"tetris-keys-group"},[o("div",null,{class:"tetris-keys-group-label"},"Rotate",3,null),n(g,{index:1,pressedKeyIndex:a,[s]:{index:s,pressedKeyIndex:s}},3,"0J_6")],1,null),o("div",null,{class:"tetris-keys-group"},[o("div",null,{class:"tetris-keys-group-label"},"Fall Faster:",3,null),n(g,{index:2,pressedKeyIndex:a,[s]:{index:s,pressedKeyIndex:s}},3,"0J_7")],1,null)],1,null)],1,"0J_8")},F=`.tetris-keys-group-label{font-feature-settings:"ss01" on,"cv10" on,"calt" off,"liga" off}.tetris-keys-group-label{font-size:12px;line-height:16px}@keyframes hue-rotate{0%{filter:hue-rotate(0deg)}to{filter:hue-rotate(360deg)}}.tetris{padding-bottom:52px;padding-top:180px}.tetris-game-board{background:linear-gradient(to bottom,rgba(175,147,255,0) 0%,rgba(175,147,255,.12) 100%);width:320px;height:100%;position:absolute;top:0;left:50%;transform:translate(-50%,100%);transition:.45s cubic-bezier(.6,.6,0,1) transform}.tetris-game-board-wrapper{position:absolute;width:100%;height:100%;top:0;left:0;pointer-events:none;overflow:hidden}.tetris-game-board:before,.tetris-game-board:after{background:linear-gradient(to bottom,rgba(175,147,255,0) 0%,rgba(175,147,255,.24) 100%);height:100%;width:1px;top:0;position:absolute;content:""}.tetris-game-board:before{left:0}.tetris-game-board:after{right:0}.tetris-box{border-radius:24px;height:640px;margin:0 auto;padding-top:176px;position:relative;width:896px;min-width:896px}.tetris-box .button{margin:38px auto 0}.tetris-box-content{transition:1s cubic-bezier(.6,.6,0,1) transform}.tetris-background{height:100%;left:0;border-radius:inherit;position:absolute;top:0;width:100%}.tetris-background-playing{opacity:0}.tetris-playing .tetris-background-playing{opacity:1}.tetris-playing .tetris-background-default{opacity:0}.tetris-playing .tetris-game-board{transform:translate(-50%)}.tetris-playing .tetris-box-content{transform:translateY(-320px)}.tetris-keys{display:flex;justify-content:center;margin-top:20px}.tetris-keys-group{align-items:center;display:flex}.tetris-keys-group:not(:last-child){margin-right:32px}.tetris-keys-group svg{opacity:.24}.tetris-keys-group-label,.tetris-keys-group-item{margin-right:8px}.tetris-keys-group-label{color:#efedfd52}.tetris-keys-group-item{align-items:center;background:linear-gradient(180deg,rgba(255,255,255,0) 0%,rgba(255,255,255,.12) 100%),rgba(3,0,20,.5);border-radius:4px;display:flex;height:24px;justify-content:center;position:relative;width:24px}.tetris-keys-group-item:last-child{margin-right:0}.tetris-keys-group-item:before{border:1px solid rgba(255,255,255,.06);border-radius:inherit;box-shadow:0 2px #ffffff14,inset 0 0 8px #ffffff0a;content:"";height:calc(100% - 2px);left:0;position:absolute;top:0;width:calc(100% - 2px)}.tetris-keys-group-item:after{background:linear-gradient(180deg,rgba(255,255,255,0) 0%,rgba(255,255,255,.12) 100%),rgba(3,0,20,.5);border-radius:inherit;content:"";height:100%;left:0;opacity:0;position:absolute;top:0;width:100%}.tetris-keys-group-item-pressed{transform:translateY(1px)}.tetris-keys-group-item-pressed svg{opacity:.7}.tetris-keys-group-item-pressed:before{box-shadow:none}.tetris-keys-group-item-pressed:after{opacity:1}@media (max-width: 1248px){.tetris{display:flex;justify-content:center;padding-top:0}.tetris-box{height:704px;width:390px;min-width:390px;border-radius:0;padding-top:6px}.tetris-keys{display:none}.tetris .section-header-description{max-width:330px}.tetris-game-board{display:none}}
`,M=F,U=()=>window.location.replace("https://reflect.academy/"),h=Object.freeze(Object.defineProperty({__proto__:null,s_IUUOeBPeP0E:J,s_IoH6X4TLWDA:R,s_PrcrG2piNtU:U,s_W63jK5fOeLw:M,s_x9weZ5KDWSY:P},Symbol.toStringTag,{value:"Module"}));export{Z as T,h as e};
